import{_ as V}from"./chunks/theme.CBbWuF7B.js";import{f as A,v as I,c as J,U as M,R as O,b as T}from"./chunks/index.DISW28_u.js";import{r as l,o as j,b as f,d as g,g as s,t as h,f as o,e as y,j as w,k as $,C as q,y as k,_ as E}from"./chunks/framework.BMc-2bSs.js";class G{get(){return JSON.parse(localStorage.getItem("directus-data"))}set(a){localStorage.setItem("directus-data",JSON.stringify(a))}}const n=A("https://dbs.chromatone.center/").with(I({credentials:"include"})).with(J("json",{credentials:"include",storage:new G})).with(M({credentials:"include"})),p=l(),D=l(""),R=l(""),b=l({}),_=l("");let S=!1;function C(){return S||(j(async()=>{await L(),await U()}),S=!0),{access_token:_,email:D,password:R,authData:b,user:p,userDB:n,userCreate:F,userRead:U,refreshToken:L,submitLogin:z,logoutUser:H}}async function L(){try{let e=await n.refresh();_.value=e.access_token,delete e.access_token,b.value=e}catch(e){console.log(e.errors[0])}}async function z(){try{let e=await n.login(D.value,R.value);_.value=e.access_token,delete e.access_token,b.value={...e}}catch(e){console.log(e.errors[0])}}async function U(){try{return p.value=await n.request(O()),p.value.players=await n.request(T("players",{fields:["*",{synths:["*",{synths_id:["*"]}]}]})),p.value}catch(e){console.log(e)}}async function F({email:e}){}async function H(){await n.logout(),_.value="",b.value=""}const K={class:"flex flex-col gap-4 p-4"},Q=s("div",{class:"text-xl"},"Profile",-1),W={class:"text-sm"},X={__name:"AuthProfile",setup(e){const{user:a}=C();return(x,v)=>(f(),g("div",K,[Q,s("pre",W,h(o(a)),1)]))}},Y=s("div",{class:"text-4xl"},"Login to your account",-1),Z=s("label",{class:"text-xl",for:"email"},"E-mail*:",-1),ee=s("label",{class:"text-xl",for:"email"},"Password:",-1),te={key:1,class:"flex flex-col gap-2"},se={class:"font-mono text-xs"},oe={class:"text-sm"},re={class:"flex"},ae={__name:"AuthLogin",setup(e){const{userRead:a,user:x,userDB:v,email:d,password:i,authData:m,access_token:c,submitLogin:u,refreshToken:P,logoutUser:B}=C();return(de,t)=>{const N=X;return o(c)?(f(),g("div",te,[s("p",se,"."+h(o(c).split(".")[2]),1),s("pre",oe,h(o(m)),1),s("div",re,[s("button",{class:"text-xl font-bold rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-lg dark-bg-dark-200",type:"submit",onClick:t[4]||(t[4]=r=>o(P)())},"Refresh"),s("button",{class:"text-xl font-bold rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-lg dark-bg-dark-200",type:"submit",onClick:t[5]||(t[5]=r=>o(B)())},"Log out")]),s("button",{class:"text-xl font-bold rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-lg dark-bg-dark-200",type:"submit",onClick:t[6]||(t[6]=r=>o(a)())},"Read user"),k(N)])):(f(),g("form",{key:0,class:"flex flex-col gap-4",onSubmit:t[3]||(t[3]=q((...r)=>o(u)&&o(u)(...r),["prevent"]))},[Y,Z,y(s("input",{class:"text-lg rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-inner dark-bg-dark-200",id:"email",type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>$(d)?d.value=r:null)},null,512),[[w,o(d)]]),ee,y(s("input",{class:"rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-inner dark-bg-dark-200",type:"password","onUpdate:modelValue":t[1]||(t[1]=r=>$(i)?i.value=r:null)},null,512),[[w,o(i)]]),s("button",{class:"text-xl font-bold rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-lg dark-bg-dark-200",type:"submit",onClick:t[2]||(t[2]=(...r)=>o(u)&&o(u)(...r))},"Sign In")],32))}}},pe=JSON.parse('{"title":"Login","description":"","frontmatter":{"title":"Login","desctiption":"Get in touch with community through contributions"},"headers":[],"relativePath":"auth/index.md","filePath":"auth/index.md","lastUpdated":1716281170000}'),ne={name:"auth/index.md"};function le(e,a,x,v,d,i){const m=ae,c=V;return f(),g("div",null,[k(m),k(c)])}const fe=E(ne,[["render",le]]);export{pe as __pageData,fe as default};
