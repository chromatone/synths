import{_ as V}from"./chunks/theme.DaoXcD6v.js";import{l as A,R as I,n as J,v as M,k as O,w as T}from"./chunks/index.CVGuM2cA.js";import{r as l,o as j,f as g,h as f,k as s,t as h,u as o,j as w,p as y,i as $,H as q,D as k,_ as E}from"./chunks/framework.Ch2f3zJW.js";class G{get(){return JSON.parse(localStorage.getItem("directus-data"))}set(a){localStorage.setItem("directus-data",JSON.stringify(a))}}const n=A("https://dbs.chromatone.center/").with(I({credentials:"include"})).with(J("json",{credentials:"include",storage:new G})).with(M({credentials:"include"})),p=l(),R=l(""),P=l(""),_=l({}),b=l("");let S=!1;function U(){return S||(j(async()=>{await D(),await L()}),S=!0),{access_token:b,email:R,password:P,authData:_,user:p,userDB:n,userCreate:z,userRead:L,refreshToken:D,submitLogin:H,logoutUser:F}}async function D(){try{let e=await n.refresh();b.value=e.access_token,delete e.access_token,_.value=e}catch(e){console.log(e.errors[0])}}async function H(){try{let e=await n.login(R.value,P.value);b.value=e.access_token,delete e.access_token,_.value={...e}}catch(e){console.log(e.errors[0])}}async function L(){try{return p.value=await n.request(O()),p.value.players=await n.request(T("players",{fields:["*",{synths:["*",{synths_id:["*"]}]}]})),p.value}catch(e){console.log(e)}}async function z({email:e}){}async function F(){await n.logout(),b.value="",_.value=""}const K={class:"flex flex-col gap-4 p-4"},Q=s("div",{class:"text-xl"},"Profile",-1),W={class:"text-sm"},X={__name:"AuthProfile",setup(e){const{user:a}=U();return(x,v)=>(g(),f("div",K,[Q,s("pre",W,h(o(a)),1)]))}},Y=s("div",{class:"text-4xl"},"Login to your account",-1),Z=s("label",{class:"text-xl",for:"email"},"E-mail*:",-1),ee=s("label",{class:"text-xl",for:"email"},"Password:",-1),te={key:1,class:"flex flex-col gap-2"},se={class:"font-mono text-xs"},oe={class:"text-sm"},re={class:"flex"},ae={__name:"AuthLogin",setup(e){const{userRead:a,user:x,userDB:v,email:d,password:i,authData:m,access_token:c,submitLogin:u,refreshToken:B,logoutUser:C}=U();return(de,t)=>{const N=X;return o(c)?(g(),f("div",te,[s("p",se,"."+h(o(c).split(".")[2]),1),s("pre",oe,h(o(m)),1),s("div",re,[s("button",{class:"text-xl font-bold rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-lg dark-bg-dark-200",type:"submit",onClick:t[4]||(t[4]=r=>o(B)())},"Refresh"),s("button",{class:"text-xl font-bold rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-lg dark-bg-dark-200",type:"submit",onClick:t[5]||(t[5]=r=>o(C)())},"Log out")]),s("button",{class:"text-xl font-bold rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-lg dark-bg-dark-200",type:"submit",onClick:t[6]||(t[6]=r=>o(a)())},"Read user"),k(N)])):(g(),f("form",{key:0,class:"flex flex-col gap-4",onSubmit:t[3]||(t[3]=q((...r)=>o(u)&&o(u)(...r),["prevent"]))},[Y,Z,w(s("input",{class:"text-lg rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-inner dark-bg-dark-200",id:"email",type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>$(d)?d.value=r:null)},null,512),[[y,o(d)]]),ee,w(s("input",{class:"rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-inner dark-bg-dark-200",type:"password","onUpdate:modelValue":t[1]||(t[1]=r=>$(i)?i.value=r:null)},null,512),[[y,o(i)]]),s("button",{class:"text-xl font-bold rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-lg dark-bg-dark-200",type:"submit",onClick:t[2]||(t[2]=(...r)=>o(u)&&o(u)(...r))},"Sign In")],32))}}},pe=JSON.parse('{"title":"Login","description":"","frontmatter":{"title":"Login","desctiption":"Get in touch with community through contributions"},"headers":[],"relativePath":"auth/index.md","filePath":"auth/index.md","lastUpdated":1724317618000}'),ne={name:"auth/index.md"};function le(e,a,x,v,d,i){const m=ae,c=V;return g(),f("div",null,[k(m),k(c)])}const ge=E(ne,[["render",le]]);export{pe as __pageData,ge as default};
