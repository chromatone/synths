import{c as P,d as y}from"./index.93d9c75a.js";import{r as t,z as g,E as S,e as E}from"./framework.e7ab0c78.js";const f=P("history"),w=/^([a-zA-Z0-9._%+-]{1,64})@[a-zA-Z0-9.-]{1,255}\.[a-zA-Z]{2,10}$/,b=100,c=t(!1),h=t(!1),j=t(!1),s=y("storedEmail",""),i=y("storedName",""),l=t(!1),o=t(s),d=t(i),m=g(()=>{var a;return T((a=o.value.match(w))==null?void 0:a[1])}),z=t(""),O=t(""),N=g(()=>A(o.value)),p=t(!1),v=t(!1);function A(a){return w.test(a)}function T(a=""){return a.charAt(0).toUpperCase()+a.slice(1)}function k(){s.value="",i.value="",l.value=!1,c.value=!1}function J(){return p.value||(S(c,a=>{a&&(h.value=!1)}),E(()=>{s.value&&(c.value=!0),f.token&&x()}),p.value=!0),{searchParams:f,isAccessGranted:c,isValidEmail:N,email:o,name:d,grantAccess:F,isSent:l,isFormOpen:h,checkAvailability:j,storedEmail:s,storedName:i,resetEmail:k,namePlaceholder:m,password:z,passwordPlaceholder:O,generatePassword:U,maxLength:b,claimInvite:C,invited:v}}async function x(){console.log(f.token,s.value)}async function C(){var a,r,n;if(s.value&&!v.value){const u={email:s.value};try{const e=await fetch("https://db.synth.chromatone.center/flows/trigger/164bb1bb-3745-423f-8239-703198dfbac5",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(u)});console.log(await(e==null?void 0:e.json()))}catch(e){console.error(e,(r=(a=e==null?void 0:e.errors)==null?void 0:a[0])==null?void 0:r.message,(n=e==null?void 0:e.response)==null?void 0:n.status)}v.value=!0}}async function F(){var a,r,n;if(!(!o.value&&!A(o.value))&&(c.value=!0,!l.value)){l.value=!0;const u={email:o.value,name:(d.value||m.value||"").slice(0,b)};try{s.value=o.value,i.value=d.value||m.value;const e=await fetch("https://db.synth.chromatone.center/flows/trigger/51cc7591-219e-4b56-ad6d-c39a34f7cf2f",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(u)});console.log(await(e==null?void 0:e.json()))}catch(e){console.error(e,(r=(a=e==null?void 0:e.errors)==null?void 0:a[0])==null?void 0:r.message,(n=e==null?void 0:e.response)==null?void 0:n.status)}}}function U(){return[...window.crypto.getRandomValues(new Uint8Array(16))].map(a=>"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_.,!?$%&*#@".charAt(a%72)).join("").slice(0,10)}export{J as u};
