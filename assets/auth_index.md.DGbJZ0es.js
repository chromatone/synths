import{_ as V}from"./chunks/theme.DRewWhTP.js";import{l as A,R as I,n as J,v as M,k as O,w as T}from"./chunks/index.PtcMEPcF.js";import{r as l,o as j,f,h as b,k as s,t as _,u as o,j as w,p as y,i as $,H as q,D as h,_ as E}from"./chunks/framework.CNQhAbrz.js";class G{get(){return JSON.parse(localStorage.getItem("directus-data"))}set(a){localStorage.setItem("directus-data",JSON.stringify(a))}}const n=A("https://dbs.chromatone.center/").with(I({credentials:"include"})).with(J("json",{credentials:"include",storage:new G})).with(M({credentials:"include"})),g=l(),R=l(""),P=l(""),m=l({}),k=l("");let S=!1;function U(){return S||(j(async()=>{await D(),await L()}),S=!0),{access_token:k,email:R,password:P,authData:m,user:g,userDB:n,userCreate:z,userRead:L,refreshToken:D,submitLogin:H,logoutUser:F}}async function D(){try{let t=await n.refresh();k.value=t.access_token,delete t.access_token,m.value=t}catch(t){console.log(t.errors[0])}}async function H(){try{let t=await n.login(R.value,P.value);k.value=t.access_token,delete t.access_token,m.value={...t}}catch(t){console.log(t.errors[0])}}async function L(){try{return g.value=await n.request(O()),g.value.players=await n.request(T("players",{fields:["*",{synths:["*",{synths_id:["*"]}]}]})),g.value}catch(t){console.log(t)}}async function z({email:t}){}async function F(){await n.logout(),k.value="",m.value=""}const K={class:"flex flex-col gap-4 p-4"},Q={class:"text-sm"},W={__name:"AuthProfile",setup(t){const{user:a}=U();return(v,d)=>(f(),b("div",K,[d[0]||(d[0]=s("div",{class:"text-xl"},"Profile",-1)),s("pre",Q,_(o(a)),1)]))}},X={key:1,class:"flex flex-col gap-2"},Y={class:"font-mono text-xs"},Z={class:"text-sm"},ee={class:"flex"},te={__name:"AuthLogin",setup(t){const{userRead:a,user:v,userDB:d,email:i,password:u,authData:x,access_token:c,submitLogin:p,refreshToken:B,logoutUser:C}=U();return(re,e)=>{const N=W;return o(c)?(f(),b("div",X,[s("p",Y,"."+_(o(c).split(".")[2]),1),s("pre",Z,_(o(x)),1),s("div",ee,[s("button",{class:"text-xl font-bold rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-lg dark-bg-dark-200",type:"submit",onClick:e[4]||(e[4]=r=>o(B)())},"Refresh"),s("button",{class:"text-xl font-bold rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-lg dark-bg-dark-200",type:"submit",onClick:e[5]||(e[5]=r=>o(C)())},"Log out")]),s("button",{class:"text-xl font-bold rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-lg dark-bg-dark-200",type:"submit",onClick:e[6]||(e[6]=r=>o(a)())},"Read user"),h(N)])):(f(),b("form",{key:0,class:"flex flex-col gap-4",onSubmit:e[3]||(e[3]=q((...r)=>o(p)&&o(p)(...r),["prevent"]))},[e[7]||(e[7]=s("div",{class:"text-4xl"},"Login to your account",-1)),e[8]||(e[8]=s("label",{class:"text-xl",for:"email"},"E-mail*:",-1)),w(s("input",{class:"text-lg rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-inner dark-bg-dark-200",id:"email",type:"text","onUpdate:modelValue":e[0]||(e[0]=r=>$(i)?i.value=r:null)},null,512),[[y,o(i)]]),e[9]||(e[9]=s("label",{class:"text-xl",for:"email"},"Password:",-1)),w(s("input",{class:"rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-inner dark-bg-dark-200",type:"password","onUpdate:modelValue":e[1]||(e[1]=r=>$(u)?u.value=r:null)},null,512),[[y,o(u)]]),s("button",{class:"text-xl font-bold rounded-lg p-4 border-2 border-solid dark-border-light-300 border-dark-800 shadow-lg dark-bg-dark-200",type:"submit",onClick:e[2]||(e[2]=(...r)=>o(p)&&o(p)(...r))},"Sign In")],32))}}},de=JSON.parse('{"title":"Login","description":"","frontmatter":{"title":"Login","desctiption":"Get in touch with community through contributions"},"headers":[],"relativePath":"auth/index.md","filePath":"auth/index.md","lastUpdated":1727931269000}'),se={name:"auth/index.md"};function oe(t,a,v,d,i,u){const x=te,c=V;return f(),b("div",null,[h(x),h(c)])}const ie=E(se,[["render",oe]]);export{de as __pageData,ie as default};
